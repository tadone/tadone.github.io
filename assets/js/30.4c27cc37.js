(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{212:function(e,t,a){"use strict";a.r(t);var s=a(0),n=Object(s.a)({},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"troubleshooting-kubernetes"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#troubleshooting-kubernetes","aria-hidden":"true"}},[e._v("#")]),e._v(" Troubleshooting Kubernetes")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://kukulinski.com/10-most-common-reasons-kubernetes-deployments-fail-part-1/",target:"_blank",rel:"noopener noreferrer"}},[e._v("10 Most Common Reasons Kubernetes Deployments Fail (Part 1)"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://kukulinski.com/10-most-common-reasons-kubernetes-deployments-fail-part-2/",target:"_blank",rel:"noopener noreferrer"}},[e._v("10 Most Common Reasons Kubernetes Deployments Fail (Part 2)"),a("OutboundLink")],1)])]),e._v(" "),a("p",[e._v("When pods are not ready for a long time or they restart multiple times:")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("kubectl describe pod <pod_name> -n <optional_namespace>")])]),e._v(" "),a("li",[a("code",[e._v("kubectl describe deployment <deployment_name>")])]),e._v(" "),a("li",[a("code",[e._v("kubectl describe replicaset <replicaset_name>")])])]),e._v(" "),a("h2",{attrs:{id:"find-pods"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#find-pods","aria-hidden":"true"}},[e._v("#")]),e._v(" Find Pods")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Example sorting pods by nodeName:")]),e._v("\nkubectl get pods -o wide --sort-by"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"{.spec.nodeName}"')]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# find all pods that not in running phase:")]),e._v("\nkubectl get pods --field-selector"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("status.phase"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("!=")]),e._v("Running --all-namespaces\n")])])]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Example of getting pods on nodes using label filter:")]),e._v("\nkubectl get pods --all-namespaces  --no-headers --field-selector spec.nodeName"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"k8s-workers-17781035-2"')]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Or for all nodes:")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" n "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("in")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$(")]),e._v("kubectl get nodes -l your_label_key"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("your_label_value --no-headers "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("cut")]),e._v(" -d "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('" "')]),e._v(" -f1"),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v(")")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("do")]),e._v("\n    kubectl get pods --all-namespaces  --no-headers --field-selector spec.nodeName"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("${n}")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("done")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Sort by number of restarts:")]),e._v("\nkubectl get pods --sort-by"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"{.status.containerStatuses[:1].restartCount}"')]),e._v("\n")])])]),a("h2",{attrs:{id:"pods-phases"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pods-phases","aria-hidden":"true"}},[e._v("#")]),e._v(" Pods Phases")]),e._v(" "),a("p",[e._v("The phase of a Pod is a simple, high-level summary of where the Pod is in its lifecycle.")]),e._v(" "),a("p",[a("strong",[e._v("Pending:")]),e._v("\tThe Pod has been accepted by the Kubernetes system, but one or more of the Container images has not been created. This includes time before being scheduled as well as time spent downloading images over the network, which could take a while.")]),e._v(" "),a("p",[a("strong",[e._v("Running:")]),e._v("\tThe Pod has been bound to a node, and all of the Containers have been created. At least one Container is still running, or is in the process of starting or restarting.")]),e._v(" "),a("p",[a("strong",[e._v("Succeeded:")]),e._v("\tAll Containers in the Pod have terminated in success, and will not be restarted.")]),e._v(" "),a("p",[a("strong",[e._v("Failed:")]),e._v("\tAll Containers in the Pod have terminated, and at least one Container has terminated in failure. That is, the Container either exited with non-zero status or was terminated by the system.")]),e._v(" "),a("p",[a("strong",[e._v("Unknown:")]),e._v("\tFor some reason the state of the Pod could not be obtained, typically due to an error in communicating with the host of the Pod.")]),e._v(" "),a("h2",{attrs:{id:"search-logs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#search-logs","aria-hidden":"true"}},[e._v("#")]),e._v(" Search Logs")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Use exec to run commands inside a container")]),e._v("\n$ kubectl "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("exec")]),e._v(" cassandra -- "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("cat")]),e._v(" /var/log/cassandra/system.log\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# If your container has previously crashed, you can access the previous container's crash log with:")]),e._v("\n$ kubectl logs --previous "),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("${POD_NAME}")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("${CONTAINER_NAME}")]),e._v("\n")])])]),a("h2",{attrs:{id:"pod-crashing"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pod-crashing","aria-hidden":"true"}},[e._v("#")]),e._v(" Pod Crashing")]),e._v(" "),a("h4",{attrs:{id:"pod-crashloopbackoff-starting-then-crashing-then-starting-again-and-crashing-again"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pod-crashloopbackoff-starting-then-crashing-then-starting-again-and-crashing-again","aria-hidden":"true"}},[e._v("#")]),e._v(" Pod CrashLoopBackOff: starting, then crashing, then starting again and crashing again")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://kubernetes.io/docs/tasks/debug-application-cluster/debug-init-containers/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Kubernetes.io/Debug-Init-Containers"),a("OutboundLink")],1)])]),e._v(" "),a("table",[a("thead",[a("tr",[a("th",[e._v("Status")]),e._v(" "),a("th",[e._v("Meaning")])])]),e._v(" "),a("tbody",[a("tr",[a("td",[e._v("Init:N/M")]),e._v(" "),a("td",[e._v("The Pod has M Init Containers, and N have completed so far.")])]),e._v(" "),a("tr",[a("td",[e._v("Init:Error")]),e._v(" "),a("td",[e._v("An Init Container has failed to execute.")])]),e._v(" "),a("tr",[a("td",[e._v("Init:CrashLoopBackOff")]),e._v(" "),a("td",[e._v("An Init Container has failed repeatedly.")])]),e._v(" "),a("tr",[a("td",[e._v("Pending")]),e._v(" "),a("td",[e._v("The Pod has not yet begun executing Init Containers.")])]),e._v(" "),a("tr",[a("td",[e._v("PodInitializing or Running")]),e._v(" "),a("td",[e._v("The Pod has already finished executing Init Containers.")])]),e._v(" "),a("tr",[a("td",[e._v("ImagePullBackOff")]),e._v(" "),a("td",[e._v("Could not pull the image from registry")])]),e._v(" "),a("tr",[a("td",[e._v("CrashLoopBackOff")]),e._v(" "),a("td",[e._v("Application Crashing after Launch")])]),e._v(" "),a("tr",[a("td",[e._v("RunContainerError")]),e._v(" "),a("td",[e._v("Missing ConfigMap")])]),e._v(" "),a("tr",[a("td",[e._v("ContainerCreating")]),e._v(" "),a("td",[e._v("(Stuck for long time) Missing secret")])]),e._v(" "),a("tr",[a("td",[e._v("Pending (Other)")]),e._v(" "),a("td",[e._v("Resource Quotas, Insufficient Cluster Resources, PersistentVolume fails to mount")])])])]),e._v(" "),a("h2",{attrs:{id:"node-not-schedulable"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#node-not-schedulable","aria-hidden":"true"}},[e._v("#")]),e._v(" Node Not Schedulable")]),e._v(" "),a("p",[e._v("Find out what's wrong with a node:")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("kubectl get nodes")]),e._v(" for status of nodes")]),e._v(" "),a("li",[a("code",[e._v("kubectl top node <node_name>")]),e._v(" for resource allocation")]),e._v(" "),a("li",[a("code",[e._v("kubectl describe node <node_namee>")]),e._v(" to get more indepth info about the node")])]),e._v(" "),a("p",[e._v("SSH to a node to view the logs: "),a("code",[e._v("journalctl -u kubelet")])])])},[],!1,null,null,null);t.default=n.exports}}]);