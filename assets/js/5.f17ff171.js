(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{169:function(s,a,t){"use strict";t.r(a);var e=t(0),r=Object(e.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("div",{staticClass:"content"},[t("h1",{attrs:{id:"azure-cli"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#azure-cli","aria-hidden":"true"}},[s._v("#")]),s._v(" Azure CLI")]),s._v(" "),t("p",[s._v("::: info\nInstall with Homebrew: "),t("code",[s._v("brew install azure-cli")]),s._v("\nFind commands with "),t("code",[s._v("az find -q rbac")]),s._v("\n:::")]),s._v(" "),t("h2",{attrs:{id:"login"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#login","aria-hidden":"true"}},[s._v("#")]),s._v(" Login")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("az login "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Use browser to enter code and associate the credentials")]),s._v("\naz login -u "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("username"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -p "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("password"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Will not work with 2-factor authentication")]),s._v("\n")])])]),t("h2",{attrs:{id:"set-acount"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#set-acount","aria-hidden":"true"}},[s._v("#")]),s._v(" Set Acount")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("az account list --output table "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# List account names & subscriptions")]),s._v("\naz account "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" --subscription "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MSI-SWE-CIE-DEV"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Change subscription")]),s._v("\naz account show --query "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tenantId'")]),s._v(" -o tsv "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Show tenantId")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Create a VM in specific subscription & resource group")]),s._v("\naz vm create --subscription "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"My Demos"')]),s._v(" --resource-group MyGroup --name NewVM --image Ubuntu\n")])])]),t("h2",{attrs:{id:"set-cloud"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#set-cloud","aria-hidden":"true"}},[s._v("#")]),s._v(" Set Cloud")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("az cloud list --output table "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Show current active cloud (default: AzureCloud)")]),s._v("\naz cloud "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" --name AzureUSGovernment "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Switch to US Gov Cloud")]),s._v("\n")])])]),t("h2",{attrs:{id:"locations"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#locations","aria-hidden":"true"}},[s._v("#")]),s._v(" Locations")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("az account list-locations "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" jq "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.[].name'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sort")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# list locations")]),s._v("\n")])])]),t("h2",{attrs:{id:"output-format"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#output-format","aria-hidden":"true"}},[s._v("#")]),s._v(" Output Format")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("â€“output")]),s._v(" "),t("th",[s._v("Description")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("json")]),s._v(" "),t("td",[s._v("JSON string. This setting is the default.")])]),s._v(" "),t("tr",[t("td",[s._v("jsonc")]),s._v(" "),t("td",[s._v("Colorized JSON.")])]),s._v(" "),t("tr",[t("td",[s._v("table")]),s._v(" "),t("td",[s._v("ASCII table with keys as column headings.")])]),s._v(" "),t("tr",[t("td",[s._v("tsv")]),s._v(" "),t("td",[s._v("Tab-separated values, with no keys")])])])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Example")]),s._v("\naz vm list --out table\naz vm list --out tsv "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" RGD "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cut")]),s._v(" -f8\n")])])]),t("h2",{attrs:{id:"query"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#query","aria-hidden":"true"}},[s._v("#")]),s._v(" Query")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Query the array (multiple output) where 2nd field is a field in JSON")]),s._v("\naz cloud list --query "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'[].{cloud_name:name, active:isActive}'")]),s._v("\n")])])]),t("h2",{attrs:{id:"arm-deployment"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#arm-deployment","aria-hidden":"true"}},[s._v("#")]),s._v(" ARM Deployment")]),s._v(" "),t("p",[s._v("Use "),t("code",[s._v("az group")]),s._v(" for deploying arm templates")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Create a deployment from a remote template file, using parameters from a local JSON file.")]),s._v("\naz group deployment create -g "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MyResourceGroup"')]),s._v(" --template-uri "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://myresource/azuredeploy.json"')]),s._v(" --parameters @myparameters.json\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Create a deployment from a local template file, using parameters from a JSON string.")]),s._v("\naz group deployment create -g "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MyResourceGroup"')]),s._v(" --template-file azuredeploy.json --parameters "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'{\n                                "location": {\n                                    "value": "westus"\n                                }\n                            }\'')]),s._v("\n")])])]),t("h2",{attrs:{id:"resource-group"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#resource-group","aria-hidden":"true"}},[s._v("#")]),s._v(" Resource Group")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("az group create -l "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"westus"')]),s._v(" -n "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MyResourceGroup"')]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Create new resource group")]),s._v("\naz group delete -n "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MyResourceGroup"')]),s._v("                "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Delete resource group")]),s._v("\naz group delete --name                              "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# RG Name")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("--no-wait"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("                         "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Don't wait for command to finish")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("--yes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("                             "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Assume yes")]),s._v("\naz resource list --resource-group "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MyResourceGroup"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# List resources in the resource group")]),s._v("\naz group show --name "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MyResourceGroup"')]),s._v("              "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Get info about resource group")]),s._v("\naz group "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("export")]),s._v(" --name "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MyResourceGroup"')]),s._v("            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Export Resource Group to ARM Template")]),s._v("\naz group update --name "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MyResourceGroup"')]),s._v("\n    --set tags.Env"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Stage tags.Dept"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("IT               "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Tag existing resource group")]),s._v("\n")])])]),t("h2",{attrs:{id:"users-roles"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#users-roles","aria-hidden":"true"}},[s._v("#")]),s._v(" Users & Roles")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("az ad user list -o table                            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# List users in Azure AD")]),s._v("\n\naz role assignment list -o table                    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# List role assignments")]),s._v("\naz role assignment list "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name\\|principalName'")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# List role assignment and filter for name or principalName")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# FIND ALL ASSINGLED ROLES FOR USER")]),s._v("\naz role assignment list --all --assignee cal085@email.com\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Find if CoreID is assinged to resourc group")]),s._v("\naz role assignment list --resource-group radio2-dev --output table "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" CAL085\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# List all users assigned to resource group")]),s._v("\naz role assignment list --resource-group radio2-dev --output table\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Grant access to resource group")]),s._v("\naz role assignment create --role "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Contributor"')]),s._v(" --assignee "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CAL085@email.com"')]),s._v(" --resource-group "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"radio2-qa"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Remove access")]),s._v("\naz role assignment delete --assignee "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("assignee"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" --role "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("role"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" --resource-group "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("resource_group"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),t("h2",{attrs:{id:"key-vault"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#key-vault","aria-hidden":"true"}},[s._v("#")]),s._v(" Key Vault")]),s._v(" "),t("p",[s._v("Requires access policy for data-plane access")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Set secret")]),s._v("\naz keyvault secret "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" --vault-name "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'virtualpartnerdev720f1'")]),s._v(" --name "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'SQLPassword'")]),s._v(" --value "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Pa$"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$w0rd")]),s._v("'")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# List secrets")]),s._v("\naz keyvault secret list --vault-name "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'virtualpartnerdev720f1'")]),s._v("\n")])])]),t("h2",{attrs:{id:"virtual-machines-vm"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#virtual-machines-vm","aria-hidden":"true"}},[s._v("#")]),s._v(" Virtual Machines (VM)")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Add SSH user/key to existing VM")]),s._v("\naz vm user update -u splunk --ssh-key-value "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("/bin/cat /Users/tadswider/.ssh/id_rsa.pub"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('"')]),s._v(" -n "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"vm_name"')]),s._v(" -g "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"resource_group"')]),s._v("\n")])])]),t("h1",{attrs:{id:"azure-devops"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#azure-devops","aria-hidden":"true"}},[s._v("#")]),s._v(" Azure DevOps")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Set env variable in the pipeline (using Linux Agent)")]),s._v("\nMASTER_IP"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("az vm list-ip-addresses -g $RG_NAME -n cie-splunk-master-dev --query "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"[].virtualMachine.network.privateIpAddresses[0]"')]),s._v(" -o tsv"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"##vso[task.setvariable variable=IPADDRESS;]'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$MASTER_IP")]),s._v('"')]),s._v("\n")])])])])}],!1,null,null,null);r.options.__file="azure.md";a.default=r.exports}}]);