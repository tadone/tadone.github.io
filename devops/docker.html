<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">

    <title>Tad-Swider-Docs | Docker </title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    

    <!-- fonts -->
    <link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700" rel="stylesheet">
    <link href="//fonts.googleapis.com/css?family=Ubuntu:300,400,500,600,700" rel="stylesheet">

    <!-- stylesheets -->
    <link rel="stylesheet" href="/style/doc.css">

    <!-- favicon -->
    <link rel="icon" href="/images/favicon.ico">

    

  </head>
  <body>

   <script>window.__INITIAL_STATE__ = {"page":{"title":"Docker","path":"devops/docker.html"},"data":{"navigation":{"logo":{"text":"Tad Swider Docs","type":"link","path":"index.html"},"main":[{"text":"DEVOPS","type":"label"},{"text":"Docker","type":"link","path":"devops/docker.html"},{"text":"AWS","type":"link","path":"devops/aws.html"},{"text":"CODE","type":"label"},{"text":"Python","type":"link","path":"code/python.html"},{"text":"Bash Scripting","type":"link","path":"code/bash.html"},{"text":"Git","type":"link","path":"code/git.html"},{"text":"Markdown","type":"link","path":"code/markdown.html"},{"text":"LINUX","type":"label"},{"text":"Linux Metrics","type":"link","path":"linux/linux_metrics.html"},{"text":"Linux Basics","type":"link","path":"linux/linux_basics.html"},{"text":"Bash Shell","type":"link","path":"linux/bash_shell.html"},{"text":"Linux Tools","type":"link","path":"linux/linux_tools.html"},{"text":"OTHER","type":"label"},{"text":"Hexo Doc","type":"link","path":"other/hexo_doc.html"},{"text":"Notes","type":"link","path":"other/notes.html"},{"text":"My Setup","type":"link","path":"other/setup.html"}]}},"config":{"timezone":"UTC","root":"/","time_format":"HH:mm:ss","theme":"doc","theme_config":{"swagger_ui":{"version":2,"permalinks":true,"api_explorer":true,"download":"Download specification","show_extensions":false,"deep_linking":true,"display_operation_id":false,"doc_expansion":"none"},"search":{"skip":false,"background":false,"route":"/lunr.json"},"favicon":"images/favicon.ico"}}}</script>

    <div id="react-navigation-root"><div class="doc-navigation" data-reactroot=""><nav class="doc-navbar"><a href="/index.html" class="doc-navbar__logo"><img src="/images/logo.png" class="doc-navbar__logo__img"/><span class="doc-navbar__logo__text">Tad Swider Docs</span></a><i class="dc-icon dc-icon--close dc-icon--interactive doc-sidebar-close doc-navbar__sidebar-close doc-navbar__sidebar-close--desktop"></i><i class="dc-icon dc-icon--menu dc-icon--interactive doc-sidebar-toggle doc-navbar__sidebar-toggle"></i></nav><nav class="doc-sidebar"><div class="doc-sidebar__vertical-menu"><i class="dc-icon dc-icon--menu dc-icon--interactive doc-sidebar-toggle doc-sidebar-toggle--primary doc-sidebar__vertical-menu__item"></i><i class="dc-icon dc-icon--search dc-icon--interactive doc-sidebar__vertical-menu__item doc-sidebar__vertical-menu__item--primary"></i></div><div class="doc-sidebar-content"><div class="doc-sidebar__search-form"></div><ul class="doc-sidebar-list"></ul></div></nav></div></div>
    <div class="doc-content">
  <div class="dc-page">
    <div class="dc-card">
      <div id="react-search-results-root"></div>
      <div id="page-content" class="doc-formatting">
        <h1 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h1><hr>
<p><strong>Version</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker version</span><br><span class="line">docker info</span><br></pre></td></tr></table></figure></p>
<p><strong>Network</strong><br>Docker uses <code>docker0</code> virtual bridge interface. Each new container gets one interface automatically attached to the <code>docker0</code> virtual bridge.</p>
<p><strong>Socket</strong><br>To access Docker socket from a container mount the following volume: <code>-v /run/docker.sock:/run/docker.sock</code></p>
<h2 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h2><p>Better way of installing things when building docker images:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">RUN <span class="built_in">set</span> -ex; \ <span class="comment"># Fail when exit status not 0, print each command (debug)</span></span><br><span class="line">	apt-get update; \</span><br><span class="line">	apt-get install -y --no-install-recommends \</span><br></pre></td></tr></table></figure>
<h2 id="Build-amp-Push"><a href="#Build-amp-Push" class="headerlink" title="Build &amp; Push"></a>Build &amp; Push</h2><p>Run docker build inside a directory containing single file called <strong>Dockerfile</strong></p>
<table>
<thead>
<tr>
<th>Command</th>
<th style="text-align:left">What it does</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>docker build -t Registry/Image:tag .</code></td>
<td style="text-align:left">Build Docker image (-t with tag)</td>
</tr>
<tr>
<td><code>docker build -t registry/image:tag registry/image:another_tag .</code></td>
<td style="text-align:left">Build image and use multiple tags</td>
</tr>
<tr>
<td><code>docker build -f Dockerfile_custom -t docker.mot-solutions.com/msi/sessionmanager .</code></td>
<td style="text-align:left">Specify custom Dockerfile</td>
</tr>
<tr>
<td><code>docker push docker.mot-solutions.com/msi/sessionmanager</code></td>
<td style="text-align:left">Push built image to registry</td>
</tr>
<tr>
<td><code>docker build --no-cache ...</code></td>
<td style="text-align:left">Force Docker to clean rebuild every layer</td>
</tr>
</tbody>
</table>
<h2 id="Run"><a href="#Run" class="headerlink" title="Run"></a>Run</h2><table>
<thead>
<tr>
<th style="text-align:right">docker run â€¦</th>
<th>Explained</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right"><code>-d</code></td>
<td>In background, detached</td>
</tr>
<tr>
<td style="text-align:right"><code>--name</code></td>
<td>Container Name</td>
</tr>
<tr>
<td style="text-align:right"><code>-ti</code></td>
<td>Interactive, with pseudo terminal</td>
</tr>
<tr>
<td style="text-align:right"><code>-p HOST:CONTAINER</code></td>
<td>Port mapping Ex. <code>-p 8080:80</code></td>
</tr>
<tr>
<td style="text-align:right"><code>--rm</code></td>
<td>Remove after container stops</td>
</tr>
<tr>
<td style="text-align:right"><code>--privileged</code></td>
<td>Disable SELinux protection for this container</td>
</tr>
<tr>
<td style="text-align:right"><code>ctrl+p ctrl+q</code></td>
<td>Detach from container without stopping it</td>
</tr>
<tr>
<td style="text-align:right"><code>-v</code></td>
<td>Volume Mapping Ex. <code>-v ${PWD}/config:/config</code></td>
</tr>
<tr>
<td style="text-align:right"><code>-v /run/docker.sock:/run/docker.sock</code></td>
<td>Map Docker socket</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># RUN</span></span><br><span class="line">docker run -d --name my_container -v <span class="variable">$PWD</span>:/directory image:tag <span class="comment"># Detached (in background)</span></span><br><span class="line">docker run -it image:tag bash <span class="comment"># Run bash shell inside of a container</span></span><br><span class="line">docker run -d alpine:latest sh -c <span class="string">'while true; do date; sleep 1; done'</span></span><br><span class="line">docker run -p 8080:80 --name -e VAR=Value my_container image:tag  <span class="comment"># docker run -p 8080:80</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># COPY</span></span><br><span class="line">docker cp foo.txt mycontainer:/foo.txt                        <span class="comment"># Copy from host to container</span></span><br><span class="line">docker cp mycontainer:/foo.txt foo.txt                        <span class="comment"># Copy form container to host</span></span><br></pre></td></tr></table></figure></p>
<h2 id="Manage"><a href="#Manage" class="headerlink" title="Manage"></a>Manage</h2><table>
<thead>
<tr>
<th>Command</th>
<th style="text-align:left">What it does</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>docker newtork ls</code></td>
<td style="text-align:left">List Docker networks</td>
</tr>
<tr>
<td><code>docker volume ls</code></td>
<td style="text-align:left">List Docker volumes</td>
</tr>
<tr>
<td><code>docker ps</code></td>
<td style="text-align:left">Show running containers</td>
</tr>
<tr>
<td><code>docker ps -a</code></td>
<td style="text-align:left">Show all containers (including stopped)</td>
</tr>
<tr>
<td><code>docker exec -it &lt;my_container&gt; bash</code></td>
<td style="text-align:left">Attach to a running container with BASH shell</td>
</tr>
<tr>
<td><code>docker kill &lt;my_container&gt;</code></td>
<td style="text-align:left">Kill running container</td>
</tr>
<tr>
<td><code>docker rm &lt;my_container&gt;</code></td>
<td style="text-align:left">Remove the container (including data inside)</td>
</tr>
<tr>
<td><code>docker stats</code></td>
<td style="text-align:left">Show Docker container system stats (CPU, Mem, IOs)</td>
</tr>
<tr>
<td><code>docker stats &lt;my_container&gt;</code></td>
<td style="text-align:left">Show stats for a single container</td>
</tr>
<tr>
<td><code>docker logs &lt;my_container&gt;</code></td>
<td style="text-align:left">Show logs from a container</td>
</tr>
<tr>
<td><code>docker inspect &lt;my_container&gt;</code></td>
<td style="text-align:left">Return low-level information on Docker objects in JSON format</td>
</tr>
<tr>
<td><code>docker history &lt;image&gt;</code></td>
<td style="text-align:left">Show the history of an image</td>
</tr>
</tbody>
</table>
<h2 id="System"><a href="#System" class="headerlink" title="System"></a>System</h2><table>
<thead>
<tr>
<th>Command</th>
<th style="text-align:left">What it does</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>docker system df</code></td>
<td style="text-align:left">Show Docker disk usage</td>
</tr>
<tr>
<td><code>docker system info</code></td>
<td style="text-align:left">Display system-wide information</td>
</tr>
<tr>
<td><code>docker system prune</code></td>
<td style="text-align:left">Remove unused data</td>
</tr>
</tbody>
</table>
<h2 id="Docker-Compose"><a href="#Docker-Compose" class="headerlink" title="Docker-Compose"></a>Docker-Compose</h2><p>User version 2 over version 3. The version 3 is used when using docker swarm and removes syntax used in version 2.</p>
<table>
<thead>
<tr>
<th>What it does</th>
<th style="text-align:left">Command</th>
</tr>
</thead>
<tbody>
<tr>
<td>Stand Up docker-compose.yml stack</td>
<td style="text-align:left"><code>docker-compose up -d</code></td>
</tr>
<tr>
<td>Restart single service from docker-compose.yml</td>
<td style="text-align:left"><code>docker-compose restart &lt;service&gt;</code></td>
</tr>
<tr>
<td>Add service to docker-compose.yml and start it</td>
<td style="text-align:left"><code>docker-compose up -d --no-recreate</code></td>
</tr>
</tbody>
</table>
<h3 id="Logs"><a href="#Logs" class="headerlink" title="Logs"></a>Logs</h3><p>Show last 100 logs from docker-compose deployment<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker-compose logs</span><br><span class="line">-f            <span class="comment"># Follow log output</span></span><br><span class="line">-t            <span class="comment"># Show timestamps</span></span><br><span class="line">--tail=<span class="string">"100"</span>  <span class="comment"># Number of lines to show from the end of the logs</span></span><br><span class="line">              <span class="comment"># for each container</span></span><br></pre></td></tr></table></figure></p>
<h2 id="Tips-amp-Tricks"><a href="#Tips-amp-Tricks" class="headerlink" title="Tips &amp; Tricks"></a>Tips &amp; Tricks</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ALIASES in .bashrc or .zshrc</span></span><br><span class="line"><span class="built_in">alias</span> dps=<span class="string">'docker ps --format "table &#123;&#123;.Names&#125;&#125;\t&#123;&#123;.Image&#125;&#125;\t&#123;&#123;.Ports&#125;&#125;"'</span></span><br></pre></td></tr></table></figure>

        <div id="react-support-footer-root"></div>
      </div>
    </div>
  </div>
</div>

    


    

    <!-- js vendors -->
    <script src="//code.jquery.com/jquery-3.2.1.min.js" crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/lunr.js/2.1.0/lunr.min.js"></script>

    <!-- js source  -->
    <script src="/script/doc.js"></script>

    

  </body>
</html>
