<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Objects: Data-In | Tadone Vuepress</title>
    <meta name="description" content="Tadone Vuepress">
    <link rel="icon" href="/logo.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
  <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
  <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.d9b151b8.css" as="style"><link rel="preload" href="/assets/js/app.8ac8da26.js" as="script"><link rel="preload" href="/assets/js/22.b8c50060.js" as="script"><link rel="prefetch" href="/assets/js/10.89ae5d30.js"><link rel="prefetch" href="/assets/js/11.a75a28d9.js"><link rel="prefetch" href="/assets/js/12.97cb21a4.js"><link rel="prefetch" href="/assets/js/13.63fba130.js"><link rel="prefetch" href="/assets/js/14.3f23b28e.js"><link rel="prefetch" href="/assets/js/15.5c212fdd.js"><link rel="prefetch" href="/assets/js/16.6c4741f5.js"><link rel="prefetch" href="/assets/js/17.316138ad.js"><link rel="prefetch" href="/assets/js/18.712774dc.js"><link rel="prefetch" href="/assets/js/19.8cac1d03.js"><link rel="prefetch" href="/assets/js/2.fcb46994.js"><link rel="prefetch" href="/assets/js/20.c6295b52.js"><link rel="prefetch" href="/assets/js/21.4f5dd63e.js"><link rel="prefetch" href="/assets/js/23.d068b859.js"><link rel="prefetch" href="/assets/js/24.00bae11a.js"><link rel="prefetch" href="/assets/js/25.599b3271.js"><link rel="prefetch" href="/assets/js/26.fc534f83.js"><link rel="prefetch" href="/assets/js/27.f7fd5b9e.js"><link rel="prefetch" href="/assets/js/28.bebfaf48.js"><link rel="prefetch" href="/assets/js/29.1c3a4caf.js"><link rel="prefetch" href="/assets/js/3.fc9eb5c0.js"><link rel="prefetch" href="/assets/js/30.a1a7b142.js"><link rel="prefetch" href="/assets/js/31.074b511e.js"><link rel="prefetch" href="/assets/js/32.2f76116b.js"><link rel="prefetch" href="/assets/js/33.1e7f1c30.js"><link rel="prefetch" href="/assets/js/34.63fbe35b.js"><link rel="prefetch" href="/assets/js/35.47a5079a.js"><link rel="prefetch" href="/assets/js/36.a47a0a4e.js"><link rel="prefetch" href="/assets/js/37.3580690c.js"><link rel="prefetch" href="/assets/js/38.e86d7803.js"><link rel="prefetch" href="/assets/js/39.e89f71d4.js"><link rel="prefetch" href="/assets/js/4.5f7daeb5.js"><link rel="prefetch" href="/assets/js/40.889340c7.js"><link rel="prefetch" href="/assets/js/5.417dffac.js"><link rel="prefetch" href="/assets/js/6.f52330c7.js"><link rel="prefetch" href="/assets/js/7.e6b95d50.js"><link rel="prefetch" href="/assets/js/8.2b154f0d.js"><link rel="prefetch" href="/assets/js/9.cd3c1513.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d9b151b8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Tadone Vuepress</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://github.com/tadone" target="_blank" rel="noopener noreferrer" class="nav-link external">
  My GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://github.com/tadone" target="_blank" rel="noopener noreferrer" class="nav-link external">
  My GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>Cloud</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/cloud/aws.html" class="sidebar-link">AWS</a></li><li><a href="/cloud/azure.html" class="sidebar-link">Azure</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Code</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/code/git.html" class="sidebar-link">Git</a></li><li><a href="/code/bash.html" class="sidebar-link">Bash Scripting</a></li><li><a href="/code/python.html" class="sidebar-link">Python</a></li><li><a href="/code/python/list.html" class="sidebar-link">Python Lists</a></li><li><a href="/code/python/class.html" class="sidebar-link">Python Classes</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>DevOps</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/devops/cicd.html" class="sidebar-link">CI/CD</a></li><li><a href="/devops/docker.html" class="sidebar-link">Docker</a></li><li><a href="/devops/databases.html" class="sidebar-link">Database Technologies</a></li><li><a href="/devops/sql.html" class="sidebar-link">SQL Basics</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>Kubernetes</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/kubernetes/overview.html" class="sidebar-link">Overview</a></li><li><a href="/kubernetes/kubectl.html" class="sidebar-link">KubeCtl</a></li><li><a href="/kubernetes/cheatsheet.html" class="sidebar-link">Cheatsheet</a></li><li><a href="/kubernetes/configuration.html" class="sidebar-link">Configuration</a></li><li><a href="/kubernetes/objects_configs.html" class="active sidebar-link">Objects: Data-In</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/kubernetes/objects_configs.html#configmap" class="sidebar-link">ConfigMap</a></li><li class="sidebar-sub-header"><a href="/kubernetes/objects_configs.html#secret" class="sidebar-link">Secret</a></li><li class="sidebar-sub-header"><a href="/kubernetes/objects_configs.html#cronjob" class="sidebar-link">CronJob</a></li></ul></li><li><a href="/kubernetes/objects_volumes.html" class="sidebar-link">Objects: Volumes</a></li><li><a href="/kubernetes/objects_deployments.html" class="sidebar-link">Objects: Deployments</a></li><li><a href="/kubernetes/objects_services_ingress.html" class="sidebar-link">Objects: Services &amp; Ingress</a></li><li><a href="/kubernetes/cluster.html" class="sidebar-link">My Clusters</a></li><li><a href="/kubernetes/troubleshooting.html" class="sidebar-link">Troubleshooting</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Linux</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/linux/bash_shell.html" class="sidebar-link">Bash Shell</a></li><li><a href="/linux/linux_basics.html" class="sidebar-link">Fundementals</a></li><li><a href="/linux/linux_metrics.html" class="sidebar-link">Metrics</a></li><li><a href="/linux/linux_tools.html" class="sidebar-link">GNU Tools</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Other</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/other/markdown.html" class="sidebar-link">Markdown Cheatsheet</a></li><li><a href="/other/yaml_json.html" class="sidebar-link">YAML &amp; JSON</a></li><li><a href="/other/setup.html" class="sidebar-link">System Setup</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="kubernetes-configuration-objects"><a href="#kubernetes-configuration-objects" aria-hidden="true" class="header-anchor">#</a> Kubernetes Configuration Objects</h1> <h2 id="configmap"><a href="#configmap" aria-hidden="true" class="header-anchor">#</a> ConfigMap</h2> <p>The ConfigMap object provides mechanisms to inject containers with configuration data. A <code>ConfigMap</code> can be used to store fine-grained information like individual properties or coarse-grained information like entire configuration files or JSON blobs.</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ConfigMap
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> test<span class="token punctuation">-</span>staging<span class="token punctuation">-</span>sidekiq
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> test<span class="token punctuation">-</span>staging<span class="token punctuation">-</span>sidekiq
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> test
<span class="token key atrule">data</span><span class="token punctuation">:</span>
  <span class="token key atrule">config</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token punctuation">-</span>
    <span class="token punctuation">---</span>
    <span class="token punctuation">:</span><span class="token key atrule">verbose</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token punctuation">:</span><span class="token key atrule">environment</span><span class="token punctuation">:</span> staging
    <span class="token punctuation">:</span><span class="token key atrule">pidfile</span><span class="token punctuation">:</span> tmp/pids/sidekiq.pid
    <span class="token punctuation">:</span><span class="token key atrule">logfile</span><span class="token punctuation">:</span> log/sidekiq.log
    <span class="token punctuation">:</span><span class="token key atrule">concurrency</span><span class="token punctuation">:</span> <span class="token number">20</span>
    <span class="token punctuation">:</span><span class="token key atrule">queues</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token punctuation">[</span>default<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token punctuation">:</span><span class="token key atrule">dynamic</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token punctuation">:</span><span class="token key atrule">timeout</span><span class="token punctuation">:</span> <span class="token number">300</span>
</code></pre></div><p>The above template creates <code>ConfigMap</code> in the test namespace and is only accessible in that namespace. After that let’s use this <code>configmap</code> as a <code>volume</code> to create our <code>sidekiq.yml</code> configuration file in deployment template named <code>test-deployment.yml</code>.</p> <h3 id="configmap-as-volume"><a href="#configmap-as-volume" aria-hidden="true" class="header-anchor">#</a> ConfigMap as Volume:</h3> <div class="language-yaml extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br></div><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> extensions/v1beta1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> test<span class="token punctuation">-</span>staging
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> test<span class="token punctuation">-</span>staging
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> test
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> test<span class="token punctuation">-</span>staging
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> &lt;your<span class="token punctuation">-</span>repo<span class="token punctuation">&gt;</span>/&lt;your<span class="token punctuation">-</span>image<span class="token punctuation">-</span>name<span class="token punctuation">&gt;</span><span class="token punctuation">:</span>latest
        <span class="token key atrule">name</span><span class="token punctuation">:</span> test<span class="token punctuation">-</span>staging
        <span class="token key atrule">imagePullPolicy</span><span class="token punctuation">:</span> Always
        <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> /etc/sidekiq/config
              <span class="token key atrule">name</span><span class="token punctuation">:</span> test<span class="token punctuation">-</span>staging<span class="token punctuation">-</span>sidekiq
        <span class="token key atrule">ports</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
      <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> test<span class="token punctuation">-</span>staging<span class="token punctuation">-</span>sidekiq
          <span class="token key atrule">configMap</span><span class="token punctuation">:</span>
             <span class="token key atrule">name</span><span class="token punctuation">:</span> test<span class="token punctuation">-</span>staging<span class="token punctuation">-</span>sidekiq             <span class="token comment"># Name of ConfigMap to use</span>
             <span class="token key atrule">items</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> <span class="token key atrule">key</span><span class="token punctuation">:</span> config
                <span class="token key atrule">path</span><span class="token punctuation">:</span>  sidekiq.yml                  <span class="token comment"># File created in VolumeMount</span>
</code></pre></div><p>Further if we want to make changes, we can simply modify the <code>configmap</code> template and restart the pod or scale down/up.</p> <h3 id="configure-all-key-value-pairs-in-a-configmap-as-container-env-variables"><a href="#configure-all-key-value-pairs-in-a-configmap-as-container-env-variables" aria-hidden="true" class="header-anchor">#</a> Configure all key-value pairs in a ConfigMap as container ENV variables</h3> <p>ConfigMap with one environment variable</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code>   <span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
   <span class="token key atrule">kind</span><span class="token punctuation">:</span> ConfigMap
   <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
     <span class="token key atrule">name</span><span class="token punctuation">:</span> special<span class="token punctuation">-</span>config
     <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
   <span class="token key atrule">data</span><span class="token punctuation">:</span>
     <span class="token key atrule">SPECIAL_LEVEL</span><span class="token punctuation">:</span> very
     <span class="token key atrule">SPECIAL_TYPE</span><span class="token punctuation">:</span> charm
</code></pre></div><p>You can consume the keys of this ConfigMap in a pod using configMapKeyRef sections. Use <code>envFrom</code> to define all of the ConfigMap’s data as container environment variables. The key from the <code>ConfigMap</code> becomes the environment variable name in the Pod.</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code>   <span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
   <span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
   <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
     <span class="token key atrule">name</span><span class="token punctuation">:</span> dapi<span class="token punctuation">-</span>test<span class="token punctuation">-</span>pod
   <span class="token key atrule">spec</span><span class="token punctuation">:</span>
     <span class="token key atrule">containers</span><span class="token punctuation">:</span>
       <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> test<span class="token punctuation">-</span>container
         <span class="token key atrule">image</span><span class="token punctuation">:</span> k8s.gcr.io/busybox
         <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;/bin/sh&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-c&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;env&quot;</span> <span class="token punctuation">]</span>
         <span class="token key atrule">envFrom</span><span class="token punctuation">:</span>
         <span class="token punctuation">-</span> <span class="token key atrule">configMapRef</span><span class="token punctuation">:</span>
             <span class="token key atrule">name</span><span class="token punctuation">:</span> special<span class="token punctuation">-</span>config             <span class="token comment"># Name of the config map</span>
     <span class="token key atrule">restartPolicy</span><span class="token punctuation">:</span> Never
</code></pre></div><p>The pod will have ENV variables <code>SPECIAL_LEVEL=very</code> and <code>SPECIAL_TYPE=charm</code>.</p> <h3 id="use-configmap-defined-environment-variables-in-pod-commands"><a href="#use-configmap-defined-environment-variables-in-pod-commands" aria-hidden="true" class="header-anchor">#</a> Use ConfigMap-defined environment variables in Pod commands</h3> <p>You can use ConfigMap-defined environment variables in the command section of the Pod specification using the $(VAR_NAME) Kubernetes substitution syntax.</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> dapi<span class="token punctuation">-</span>test<span class="token punctuation">-</span>pod
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> test<span class="token punctuation">-</span>container
      <span class="token key atrule">image</span><span class="token punctuation">:</span> k8s.gcr.io/busybox
      <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;/bin/sh&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-c&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;echo $(SPECIAL_LEVEL_KEY) $(SPECIAL_TYPE_KEY)&quot;</span> <span class="token punctuation">]</span>
      <span class="token key atrule">env</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> SPECIAL_LEVEL_KEY
          <span class="token key atrule">valueFrom</span><span class="token punctuation">:</span>
            <span class="token key atrule">configMapKeyRef</span><span class="token punctuation">:</span>
              <span class="token key atrule">name</span><span class="token punctuation">:</span> special<span class="token punctuation">-</span>config
              <span class="token key atrule">key</span><span class="token punctuation">:</span> SPECIAL_LEVEL
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> SPECIAL_TYPE_KEY
          <span class="token key atrule">valueFrom</span><span class="token punctuation">:</span>
            <span class="token key atrule">configMapKeyRef</span><span class="token punctuation">:</span>
              <span class="token key atrule">name</span><span class="token punctuation">:</span> special<span class="token punctuation">-</span>config
              <span class="token key atrule">key</span><span class="token punctuation">:</span> SPECIAL_TYPE
  <span class="token key atrule">restartPolicy</span><span class="token punctuation">:</span> Never
</code></pre></div><p>Produces the following output in the test-container container: <code>very charm</code></p> <h2 id="secret"><a href="#secret" aria-hidden="true" class="header-anchor">#</a> Secret</h2> <p><code>Secrets</code> are intended to hold sensitive information, such as passwords, OAuth tokens, and ssh keys.
https://github.com/arun-gupta/vault-kubernetes/blob/master/secrets.yaml
http://kubernetesbyexample.com/secrets/</p> <ul><li>Secrets are namespaced objects, that is, exist in the context of a namespace</li> <li>You can access them via a volume or an environment variable from a container running in a pod</li> <li>The secret data on nodes is stored in tmpfs volumes</li></ul> <h3 id="create-manually"><a href="#create-manually" aria-hidden="true" class="header-anchor">#</a> Create Manually</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># Create files needed for rest of example.</span>
$ <span class="token keyword">echo</span> -n <span class="token string">'admin'</span> <span class="token operator">&gt;</span> ./username.txt
$ <span class="token keyword">echo</span> -n <span class="token string">'1f2d1e2e67df'</span> <span class="token operator">&gt;</span> ./password.txt
</code></pre></div><p>The <code>kubectl create secret</code> command packages these files into a Secret</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ kubectl create secret generic db-user-pass --from-file<span class="token operator">=</span>./username.txt --from-file<span class="token operator">=</span>./password.txt
secret <span class="token string">&quot;db-user-pass&quot;</span> created
</code></pre></div><h3 id="describe"><a href="#describe" aria-hidden="true" class="header-anchor">#</a> Describe</h3> <p>Describe the secret. Items in Data are actual values of the secret</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ kubectl describe secrets/db-user-pass
Name:            db-user-pass
Namespace:       default
Labels:          <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
Annotations:     <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>

Type:            Opaque

Data
<span class="token operator">==</span><span class="token operator">==</span>
password.txt:    12 bytes
username.txt:    5 bytes
</code></pre></div><p>Secrets can be retrieved via the <code>kubectl get secret</code> command</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ kubectl get secret mysecret -o yaml
apiVersion: v1
data:
  username: YWRtaW4<span class="token operator">=</span>
  password: MWYyZDFlMmU2N2Rm
kind: Secret
metadata:
  creationTimestamp: 2016-01-22T18:41:56Z
  name: mysecret
  namespace: default
  resourceVersion: <span class="token string">&quot;164619&quot;</span>
  selfLink: /api/v1/namespaces/default/secrets/mysecret
  uid: cfee02d6-c137-11e5-8d73-42010af00002
type: Opaque
</code></pre></div><h3 id="decode"><a href="#decode" aria-hidden="true" class="header-anchor">#</a> Decode</h3> <p>Finally, decode the secret using base64</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token keyword">echo</span> <span class="token string">'MWYyZDFlMmU2N2Rm'</span> <span class="token operator">|</span> base64 --decode
1f2d1e2e67df
</code></pre></div><h3 id="as-volume"><a href="#as-volume" aria-hidden="true" class="header-anchor">#</a> As Volume</h3> <p>Each key in the secret <code>data</code> map becomes the filename under <code>mountPath</code></p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> mypod
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> mypod
    <span class="token key atrule">image</span><span class="token punctuation">:</span> redis
    <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> foo
      <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> &quot;/etc/foo&quot; <span class="token comment"># Foo is a directory where items from 'data' will be populated as files</span>
      <span class="token key atrule">readOnly</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> foo              <span class="token comment"># Name of the volume, referenced in volumeMount</span>
    <span class="token key atrule">secret</span><span class="token punctuation">:</span>
      <span class="token key atrule">secretName</span><span class="token punctuation">:</span> mysecret <span class="token comment"># Name of the secret</span>
</code></pre></div><p>Optionally, specify specific path for items in the secret</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> mypod
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> mypod
    <span class="token key atrule">image</span><span class="token punctuation">:</span> redis
    <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> foo
      <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> <span class="token string">&quot;/etc/foo&quot;</span>
      <span class="token key atrule">readOnly</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> foo
    <span class="token key atrule">secret</span><span class="token punctuation">:</span>
      <span class="token key atrule">secretName</span><span class="token punctuation">:</span> mysecret
      <span class="token key atrule">items</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">key</span><span class="token punctuation">:</span> username
        <span class="token key atrule">path</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>group/my<span class="token punctuation">-</span>username
</code></pre></div><p>What will happen:</p> <ul><li>username secret is stored under /etc/foo/my-group/my-username file instead of /etc/foo/username.</li> <li>password secret is not projected</li></ul> <p>To consume all keys from the secret, all of them must be listed in the items field. All listed keys must exist in the corresponding secret. Otherwise, the volume is not created.</p> <p><strong>Consuming Secret Values from Volumes</strong> <em>Mounted Secrets are updated automatically</em>
Inside the container that mounts a secret volume, the secret keys appear as files and the secret values are base-64 decoded and stored inside these files.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">ls</span> /etc/foo/
username
password
$ <span class="token function">cat</span> /etc/foo/username
admin
$ <span class="token function">cat</span> /etc/foo/password
1f2d1e2e67df
</code></pre></div><h3 id="as-env-variables"><a href="#as-env-variables" aria-hidden="true" class="header-anchor">#</a> As Env Variables</h3> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> secret<span class="token punctuation">-</span>env<span class="token punctuation">-</span>pod
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> mycontainer
    <span class="token key atrule">image</span><span class="token punctuation">:</span> redis
    <span class="token key atrule">env</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> SECRET_USERNAME      <span class="token comment"># Name of the env variable</span>
        <span class="token key atrule">valueFrom</span><span class="token punctuation">:</span>
          <span class="token key atrule">secretKeyRef</span><span class="token punctuation">:</span>
            <span class="token key atrule">name</span><span class="token punctuation">:</span> mysecret
            <span class="token key atrule">key</span><span class="token punctuation">:</span> username
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> SECRET_PASSWORD      <span class="token comment"># Name of the env variable</span>
        <span class="token key atrule">valueFrom</span><span class="token punctuation">:</span>
          <span class="token key atrule">secretKeyRef</span><span class="token punctuation">:</span>
            <span class="token key atrule">name</span><span class="token punctuation">:</span> mysecret
            <span class="token key atrule">key</span><span class="token punctuation">:</span> password
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token keyword">echo</span> <span class="token variable">$SECRET_USERNAME</span>
admin
$ <span class="token keyword">echo</span> <span class="token variable">$SECRET_PASSWORD</span>
1f2d1e2e67df
</code></pre></div><h2 id="cronjob"><a href="#cronjob" aria-hidden="true" class="header-anchor">#</a> CronJob</h2> <p>https://kubernetes.io/docs/concepts/workloads/controllers/cron-jobs/</p> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl create -f ./cronjob.yaml
kubectl get cronjob hello
kubectl get <span class="token function">jobs</span> --watch
kubectl delete cronjob hello
</code></pre></div><div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> batch/v1beta1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> CronJob
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> hello
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">schedule</span><span class="token punctuation">:</span> <span class="token string">&quot;*/1 * * * *&quot;</span>
  <span class="token key atrule">jobTemplate</span><span class="token punctuation">:</span>
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">template</span><span class="token punctuation">:</span>
        <span class="token key atrule">spec</span><span class="token punctuation">:</span>
          <span class="token key atrule">containers</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> hello
            <span class="token key atrule">image</span><span class="token punctuation">:</span> busybox
            <span class="token key atrule">args</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> /bin/sh
            <span class="token punctuation">-</span> <span class="token punctuation">-</span>c
            <span class="token punctuation">-</span> date; echo Hello from the Kubernetes cluster
          <span class="token key atrule">restartPolicy</span><span class="token punctuation">:</span> OnFailure
</code></pre></div></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">11/2/2018, 10:26:10 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/kubernetes/configuration.html" class="prev">
          Configuration
        </a></span> <span class="next"><a href="/kubernetes/objects_volumes.html">
          Objects: Volumes
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.8ac8da26.js" defer></script><script src="/assets/js/22.b8c50060.js" defer></script>
  </body>
</html>
