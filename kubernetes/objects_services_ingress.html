<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Objects: Services &amp; Ingress | Tadone Vuepress</title>
    <meta name="description" content="Tadone Vuepress">
    <link rel="icon" href="/logo.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
  <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
  <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.d9b151b8.css" as="style"><link rel="preload" href="/assets/js/app.d2d468e2.js" as="script"><link rel="preload" href="/assets/js/24.00bae11a.js" as="script"><link rel="prefetch" href="/assets/js/10.89ae5d30.js"><link rel="prefetch" href="/assets/js/11.a75a28d9.js"><link rel="prefetch" href="/assets/js/12.97cb21a4.js"><link rel="prefetch" href="/assets/js/13.63fba130.js"><link rel="prefetch" href="/assets/js/14.3f23b28e.js"><link rel="prefetch" href="/assets/js/15.5c212fdd.js"><link rel="prefetch" href="/assets/js/16.6c4741f5.js"><link rel="prefetch" href="/assets/js/17.316138ad.js"><link rel="prefetch" href="/assets/js/18.712774dc.js"><link rel="prefetch" href="/assets/js/19.8cac1d03.js"><link rel="prefetch" href="/assets/js/2.fcb46994.js"><link rel="prefetch" href="/assets/js/20.c6295b52.js"><link rel="prefetch" href="/assets/js/21.4f5dd63e.js"><link rel="prefetch" href="/assets/js/22.b8c50060.js"><link rel="prefetch" href="/assets/js/23.d068b859.js"><link rel="prefetch" href="/assets/js/25.599b3271.js"><link rel="prefetch" href="/assets/js/26.fc534f83.js"><link rel="prefetch" href="/assets/js/27.f7fd5b9e.js"><link rel="prefetch" href="/assets/js/28.bebfaf48.js"><link rel="prefetch" href="/assets/js/29.1c3a4caf.js"><link rel="prefetch" href="/assets/js/3.fc9eb5c0.js"><link rel="prefetch" href="/assets/js/30.a1a7b142.js"><link rel="prefetch" href="/assets/js/31.074b511e.js"><link rel="prefetch" href="/assets/js/32.2f76116b.js"><link rel="prefetch" href="/assets/js/33.1e7f1c30.js"><link rel="prefetch" href="/assets/js/34.63fbe35b.js"><link rel="prefetch" href="/assets/js/35.47a5079a.js"><link rel="prefetch" href="/assets/js/36.a47a0a4e.js"><link rel="prefetch" href="/assets/js/37.3580690c.js"><link rel="prefetch" href="/assets/js/38.e86d7803.js"><link rel="prefetch" href="/assets/js/39.e89f71d4.js"><link rel="prefetch" href="/assets/js/4.069b95dd.js"><link rel="prefetch" href="/assets/js/40.889340c7.js"><link rel="prefetch" href="/assets/js/5.417dffac.js"><link rel="prefetch" href="/assets/js/6.f52330c7.js"><link rel="prefetch" href="/assets/js/7.e6b95d50.js"><link rel="prefetch" href="/assets/js/8.2b154f0d.js"><link rel="prefetch" href="/assets/js/9.cd3c1513.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d9b151b8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Tadone Vuepress</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://github.com/tadone" target="_blank" rel="noopener noreferrer" class="nav-link external">
  My GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://github.com/tadone" target="_blank" rel="noopener noreferrer" class="nav-link external">
  My GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>Cloud</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/cloud/aws.html" class="sidebar-link">AWS</a></li><li><a href="/cloud/azure.html" class="sidebar-link">Azure</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Code</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/code/git.html" class="sidebar-link">Git</a></li><li><a href="/code/bash.html" class="sidebar-link">Bash Scripting</a></li><li><a href="/code/python.html" class="sidebar-link">Python</a></li><li><a href="/code/python/list.html" class="sidebar-link">Python Lists</a></li><li><a href="/code/python/class.html" class="sidebar-link">Python Classes</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>DevOps</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/devops/cicd.html" class="sidebar-link">CI/CD</a></li><li><a href="/devops/docker.html" class="sidebar-link">Docker</a></li><li><a href="/devops/databases.html" class="sidebar-link">Database Technologies</a></li><li><a href="/devops/sql.html" class="sidebar-link">SQL Basics</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>Kubernetes</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/kubernetes/overview.html" class="sidebar-link">Overview</a></li><li><a href="/kubernetes/kubectl.html" class="sidebar-link">KubeCtl</a></li><li><a href="/kubernetes/cheatsheet.html" class="sidebar-link">Cheatsheet</a></li><li><a href="/kubernetes/configuration.html" class="sidebar-link">Configuration</a></li><li><a href="/kubernetes/objects_configs.html" class="sidebar-link">Objects: Data-In</a></li><li><a href="/kubernetes/objects_volumes.html" class="sidebar-link">Objects: Volumes</a></li><li><a href="/kubernetes/objects_deployments.html" class="sidebar-link">Objects: Deployments</a></li><li><a href="/kubernetes/objects_services_ingress.html" class="active sidebar-link">Objects: Services &amp; Ingress</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/kubernetes/objects_services_ingress.html#type-clusterip" class="sidebar-link">Type: ClusterIP</a></li><li class="sidebar-sub-header"><a href="/kubernetes/objects_services_ingress.html#type-nodeport" class="sidebar-link">Type: NodePort</a></li><li class="sidebar-sub-header"><a href="/kubernetes/objects_services_ingress.html#type-loadbalancer" class="sidebar-link">Type: LoadBalancer</a></li><li class="sidebar-sub-header"><a href="/kubernetes/objects_services_ingress.html#type-externalname" class="sidebar-link">Type: ExternalName</a></li><li class="sidebar-sub-header"><a href="/kubernetes/objects_services_ingress.html#type-external-ip" class="sidebar-link">Type: External IP</a></li><li class="sidebar-sub-header"><a href="/kubernetes/objects_services_ingress.html#ingress-2" class="sidebar-link">Ingress</a></li><li class="sidebar-sub-header"><a href="/kubernetes/objects_services_ingress.html#ingress-controller" class="sidebar-link">Ingress Controller</a></li></ul></li><li><a href="/kubernetes/cluster.html" class="sidebar-link">My Clusters</a></li><li><a href="/kubernetes/troubleshooting.html" class="sidebar-link">Troubleshooting</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Linux</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/linux/bash_shell.html" class="sidebar-link">Bash Shell</a></li><li><a href="/linux/linux_basics.html" class="sidebar-link">Fundementals</a></li><li><a href="/linux/linux_metrics.html" class="sidebar-link">Metrics</a></li><li><a href="/linux/linux_tools.html" class="sidebar-link">GNU Tools</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Other</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/other/markdown.html" class="sidebar-link">Markdown Cheatsheet</a></li><li><a href="/other/yaml_json.html" class="sidebar-link">YAML &amp; JSON</a></li><li><a href="/other/setup.html" class="sidebar-link">System Setup</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="services"><a href="#services" aria-hidden="true" class="header-anchor">#</a> Services</h1> <p>To make a pod accessible you can create a <strong>Service</strong> which is an abstraction that creates a logical group of <strong>Pods</strong> together and provides a way to access them. A <strong>Service</strong> uses the metadata labels assigned to <strong>Pods</strong> to determine its constituents.</p> <p>Each <strong>Service</strong> has a setting called <strong>ServiceType</strong> that defines how that service is exposed. You can set this to <strong>ClusterIP</strong>, <strong>NodePort</strong>, <strong>LoadBalancer</strong>, or <strong>ExternalName</strong> depending on your particular deployment scenario.</p> <h2 id="type-clusterip"><a href="#type-clusterip" aria-hidden="true" class="header-anchor">#</a> Type: ClusterIP</h2> <p><strong>ClusterIP</strong> is the default <strong>ServiceType</strong> and it creates a single IP address that can be used to access its <strong>Pods</strong> which can only be accessed from inside the cluster.</p> <p>The YAML for a ClusterIP service looks like this:</p> <div class="language-yaml extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br></div><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Service
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>internal<span class="token punctuation">-</span>service
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>app
  <span class="token key atrule">type</span><span class="token punctuation">:</span> ClusterIP
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> http
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span>
    <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
    <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP
</code></pre></div><h2 id="type-nodeport"><a href="#type-nodeport" aria-hidden="true" class="header-anchor">#</a> Type: NodePort</h2> <p>A <strong>NodePort</strong> service is the most primitive way to get external traffic directly to your service. <strong>NodePort</strong>, as the name implies, opens a specific port (typically 30000–32767) on all the Nodes (the VMs), and any traffic that is sent to this port is forwarded to the service.</p> <p>A Service exposed as a NodePort can be accessed via <code>&lt;node-ip-address&gt;:&lt;node-port&gt;</code>.</p> <p>The YAML for a NodePort service looks like this:</p> <div class="language-yaml extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br></div><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Service
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>nodeport<span class="token punctuation">-</span>service
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>app
  <span class="token key atrule">type</span><span class="token punctuation">:</span> NodePort
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> http
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span>
    <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
    <span class="token key atrule">nodePort</span><span class="token punctuation">:</span> <span class="token number">30036</span>
    <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP
</code></pre></div><p>The <strong>nodePort</strong> that specifies which port to open on the nodes. If you don’t specify this port, it will pick a random port. Most of the time you should let Kubernetes choose the port. This should be used as a temprorary solution.</p> <h2 id="type-loadbalancer"><a href="#type-loadbalancer" aria-hidden="true" class="header-anchor">#</a> Type: LoadBalancer</h2> <p><strong>LoadBalancer</strong> service type automatically deploys an external load balancer. This external load balancer is associated with a specific IP address and routes external traffic to a Kubernetes service in your cluster.</p> <p><strong>LoadBalancer</strong> is used to automatically configure a supported <code>external Load Balancer</code> (for instance an ELB in Amazon) to route traffic through to the <strong>NodePort</strong> of the Service. This is the most versatile of the <strong>ServiceTypes</strong> but requires that you have a supported Load Balancer in your infrastructure of which most major cloud providers have (GCE, AWS, Azure).</p> <div class="language-yaml extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Service
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>ingress
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>ingress
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">externalTrafficPolicy</span><span class="token punctuation">:</span> Local
  <span class="token key atrule">type</span><span class="token punctuation">:</span> LoadBalancer
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span>
    <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
    <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP
    <span class="token key atrule">name</span><span class="token punctuation">:</span> http
  <span class="token punctuation">-</span> <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">443</span>
    <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">443</span>
    <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP
    <span class="token key atrule">name</span><span class="token punctuation">:</span> https
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>ingress
</code></pre></div><h2 id="type-externalname"><a href="#type-externalname" aria-hidden="true" class="header-anchor">#</a> Type: ExternalName</h2> <p>ExternalName creates DNS records in KubeDNS to direct the Service’s DNS to an external service specified in the field ExternalName. It provides no other routing or load balancing services.</p> <h2 id="type-external-ip"><a href="#type-external-ip" aria-hidden="true" class="header-anchor">#</a> Type: External IP</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>$ kubectl run ghost --image<span class="token operator">=</span>ghost:2.1.4 --port<span class="token operator">=</span>2368
deployment <span class="token string">&quot;ghost&quot;</span> created
$ kubectl expose deployment ghost --external-ip<span class="token operator">=</span>192.168.10.10 --port<span class="token operator">=</span>2368 --target-port<span class="token operator">=</span>2368
<span class="token function">service</span> <span class="token string">&quot;ghost&quot;</span> exposed
$ <span class="token function">curl</span> 192.168.10.10:2368
</code></pre></div><h1 id="ingress"><a href="#ingress" aria-hidden="true" class="header-anchor">#</a> Ingress</h1> <h2 id="ingress-2"><a href="#ingress-2" aria-hidden="true" class="header-anchor">#</a> Ingress</h2> <p>Unlike all the above examples, <code>Ingress</code> is actually NOT a type of service. Instead, it sits in front of multiple services and act as a “smart router” or entrypoint into your cluster. For example, you can send everything on foo.yourdomain.com to the <strong>foo</strong> service, and everything under the yourdomain.com/bar/ path to the <strong>bar</strong> service.</p> <div class="warning custom-block"><p class="custom-block-title">WARNING</p> <p>Before using ingress resource, an ingress controller has to be installed!</p></div> <div class="language-yaml extra-class"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> extensions/v1beta1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Ingress
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> test<span class="token punctuation">-</span>ingress
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">rules</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">host</span><span class="token punctuation">:</span> foo.bar.com
    <span class="token key atrule">http</span><span class="token punctuation">:</span>
      <span class="token key atrule">paths</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">backend</span><span class="token punctuation">:</span>
          <span class="token key atrule">serviceName</span><span class="token punctuation">:</span> s1
          <span class="token key atrule">servicePort</span><span class="token punctuation">:</span> <span class="token number">80</span>
  <span class="token punctuation">-</span> <span class="token key atrule">host</span><span class="token punctuation">:</span> bar.foo.com
    <span class="token key atrule">http</span><span class="token punctuation">:</span>
      <span class="token key atrule">paths</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">backend</span><span class="token punctuation">:</span>
          <span class="token key atrule">serviceName</span><span class="token punctuation">:</span> s2
          <span class="token key atrule">servicePort</span><span class="token punctuation">:</span> <span class="token number">80</span>
</code></pre></div><h2 id="ingress-controller"><a href="#ingress-controller" aria-hidden="true" class="header-anchor">#</a> Ingress Controller</h2> <p>There are many types of <code>Ingress controllers</code>, from the Google Cloud Load Balancer, Nginx, Traefik, Ambassador, and more.</p> <p>Example of NGINX ingress controller:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> extensions/v1beta1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>ingress<span class="token punctuation">-</span>controller
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">k8s-app</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>ingress<span class="token punctuation">-</span>controller
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> ingress
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">1</span>
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">k8s-app</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>ingress<span class="token punctuation">-</span>controller
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token comment">#hostNetwork: true # If run on a single node</span>
      <span class="token key atrule">serviceAccountName</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>ingress
      <span class="token key atrule">terminationGracePeriodSeconds</span><span class="token punctuation">:</span> <span class="token number">60</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> gcr.io/google_containers/nginx<span class="token punctuation">-</span>ingress<span class="token punctuation">-</span>controller<span class="token punctuation">:</span>0.9.0<span class="token punctuation">-</span>beta.15
        <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>ingress<span class="token punctuation">-</span>controller
        <span class="token key atrule">imagePullPolicy</span><span class="token punctuation">:</span> Always
        <span class="token key atrule">ports</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
          <span class="token key atrule">hostPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
        <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">443</span>
          <span class="token key atrule">hostPort</span><span class="token punctuation">:</span> <span class="token number">443</span>
        <span class="token key atrule">env</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> POD_NAME
            <span class="token key atrule">valueFrom</span><span class="token punctuation">:</span>
              <span class="token key atrule">fieldRef</span><span class="token punctuation">:</span>
                <span class="token key atrule">fieldPath</span><span class="token punctuation">:</span> metadata.name
          <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> POD_NAMESPACE
            <span class="token key atrule">valueFrom</span><span class="token punctuation">:</span>
              <span class="token key atrule">fieldRef</span><span class="token punctuation">:</span>
                <span class="token key atrule">fieldPath</span><span class="token punctuation">:</span> metadata.namespace
        <span class="token key atrule">args</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> /nginx<span class="token punctuation">-</span>ingress<span class="token punctuation">-</span>controller
        <span class="token punctuation">-</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>default<span class="token punctuation">-</span>backend<span class="token punctuation">-</span>service=$(POD_NAMESPACE)/default<span class="token punctuation">-</span>http<span class="token punctuation">-</span>backend
        <span class="token punctuation">-</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>configmap=$(POD_NAMESPACE)/nginx<span class="token punctuation">-</span>ingress<span class="token punctuation">-</span>controller
</code></pre></div><h3 id="default-backend-optional-for-nginx"><a href="#default-backend-optional-for-nginx" aria-hidden="true" class="header-anchor">#</a> Default Backend (Optional for NGINX)</h3> <p>This pod will route all request that are not associated with any service to default backend, which will respond with 404.</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> extensions/v1beta1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> default<span class="token punctuation">-</span>http<span class="token punctuation">-</span>backend
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">k8s-app</span><span class="token punctuation">:</span> default<span class="token punctuation">-</span>http<span class="token punctuation">-</span>backend
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> ingress
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">1</span>
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">k8s-app</span><span class="token punctuation">:</span> default<span class="token punctuation">-</span>http<span class="token punctuation">-</span>backend
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">terminationGracePeriodSeconds</span><span class="token punctuation">:</span> <span class="token number">60</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> default<span class="token punctuation">-</span>http<span class="token punctuation">-</span>backend
        <span class="token comment"># Any image is permissable as long as:</span>
        <span class="token comment"># 1. It serves a 404 page at /</span>
        <span class="token comment"># 2. It serves 200 on a /healthz endpoint</span>
        <span class="token key atrule">image</span><span class="token punctuation">:</span> gcr.io/google_containers/defaultbackend<span class="token punctuation">:</span><span class="token number">1.4</span>
        <span class="token key atrule">livenessProbe</span><span class="token punctuation">:</span>
          <span class="token key atrule">httpGet</span><span class="token punctuation">:</span>
            <span class="token key atrule">path</span><span class="token punctuation">:</span> /healthz
            <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8080</span>
            <span class="token key atrule">scheme</span><span class="token punctuation">:</span> HTTP
          <span class="token key atrule">initialDelaySeconds</span><span class="token punctuation">:</span> <span class="token number">30</span>
          <span class="token key atrule">timeoutSeconds</span><span class="token punctuation">:</span> <span class="token number">5</span>
        <span class="token key atrule">ports</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">8080</span>
        <span class="token key atrule">resources</span><span class="token punctuation">:</span>
          <span class="token key atrule">limits</span><span class="token punctuation">:</span>
            <span class="token key atrule">cpu</span><span class="token punctuation">:</span> 10m
            <span class="token key atrule">memory</span><span class="token punctuation">:</span> 20Mi
          <span class="token key atrule">requests</span><span class="token punctuation">:</span>
            <span class="token key atrule">cpu</span><span class="token punctuation">:</span> 10m
            <span class="token key atrule">memory</span><span class="token punctuation">:</span> 20Mi
</code></pre></div></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">11/2/2018, 10:26:10 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/kubernetes/objects_deployments.html" class="prev">
          Objects: Deployments
        </a></span> <span class="next"><a href="/kubernetes/cluster.html">
          My Clusters
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.d2d468e2.js" defer></script><script src="/assets/js/24.00bae11a.js" defer></script>
  </body>
</html>
