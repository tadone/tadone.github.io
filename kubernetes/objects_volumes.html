<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Objects: Volumes | Tadone Vuepress</title>
    <meta name="description" content="Tadone Vuepress">
    <link rel="icon" href="/logo.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
  <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
  <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.c0a883f2.css" as="style"><link rel="preload" href="/assets/js/app.35d179c7.js" as="script"><link rel="preload" href="/assets/js/25.9719470b.js" as="script"><link rel="prefetch" href="/assets/js/10.32883c3e.js"><link rel="prefetch" href="/assets/js/11.05b4280d.js"><link rel="prefetch" href="/assets/js/12.919f0649.js"><link rel="prefetch" href="/assets/js/13.427916eb.js"><link rel="prefetch" href="/assets/js/14.c3477c8c.js"><link rel="prefetch" href="/assets/js/15.49573669.js"><link rel="prefetch" href="/assets/js/16.f64ec5a1.js"><link rel="prefetch" href="/assets/js/17.eb238722.js"><link rel="prefetch" href="/assets/js/18.754a62a6.js"><link rel="prefetch" href="/assets/js/19.cb09f3c7.js"><link rel="prefetch" href="/assets/js/2.84817a29.js"><link rel="prefetch" href="/assets/js/20.56374c85.js"><link rel="prefetch" href="/assets/js/21.784cbd5f.js"><link rel="prefetch" href="/assets/js/22.de742b8c.js"><link rel="prefetch" href="/assets/js/23.ed7c05da.js"><link rel="prefetch" href="/assets/js/24.8d5cfd9e.js"><link rel="prefetch" href="/assets/js/26.a8e33675.js"><link rel="prefetch" href="/assets/js/27.0583bdcf.js"><link rel="prefetch" href="/assets/js/28.065c0da3.js"><link rel="prefetch" href="/assets/js/29.98a00717.js"><link rel="prefetch" href="/assets/js/3.25a04740.js"><link rel="prefetch" href="/assets/js/30.0e9e5a91.js"><link rel="prefetch" href="/assets/js/31.392746e4.js"><link rel="prefetch" href="/assets/js/32.e79b67e9.js"><link rel="prefetch" href="/assets/js/33.5eb29385.js"><link rel="prefetch" href="/assets/js/34.96414370.js"><link rel="prefetch" href="/assets/js/35.5cdb421e.js"><link rel="prefetch" href="/assets/js/36.42c50f02.js"><link rel="prefetch" href="/assets/js/37.7ff67003.js"><link rel="prefetch" href="/assets/js/38.aac579d9.js"><link rel="prefetch" href="/assets/js/39.e334e64c.js"><link rel="prefetch" href="/assets/js/4.1beb5986.js"><link rel="prefetch" href="/assets/js/40.82b2abb9.js"><link rel="prefetch" href="/assets/js/5.cb0bd4a7.js"><link rel="prefetch" href="/assets/js/6.34cdd9af.js"><link rel="prefetch" href="/assets/js/7.c3a72011.js"><link rel="prefetch" href="/assets/js/8.57ad85b4.js"><link rel="prefetch" href="/assets/js/9.482bb012.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c0a883f2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Tadone Vuepress</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://github.com/tadone" target="_blank" rel="noopener noreferrer" class="nav-link external">
  My GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://github.com/tadone" target="_blank" rel="noopener noreferrer" class="nav-link external">
  My GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>Cloud</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/cloud/aws.html" class="sidebar-link">AWS</a></li><li><a href="/cloud/azure.html" class="sidebar-link">Azure</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Code</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/code/git.html" class="sidebar-link">Git</a></li><li><a href="/code/bash.html" class="sidebar-link">Bash Scripting</a></li><li><a href="/code/python.html" class="sidebar-link">Python</a></li><li><a href="/code/python/list.html" class="sidebar-link">Python Lists</a></li><li><a href="/code/python/class.html" class="sidebar-link">Python Classes</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>DevOps</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/devops/cicd.html" class="sidebar-link">CI/CD</a></li><li><a href="/devops/docker.html" class="sidebar-link">Docker</a></li><li><a href="/devops/databases.html" class="sidebar-link">Database Technologies</a></li><li><a href="/devops/sql.html" class="sidebar-link">SQL Basics</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>Kubernetes</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/kubernetes/overview.html" class="sidebar-link">Overview</a></li><li><a href="/kubernetes/kubectl.html" class="sidebar-link">KubeCtl</a></li><li><a href="/kubernetes/cheatsheet.html" class="sidebar-link">Cheatsheet</a></li><li><a href="/kubernetes/configuration.html" class="sidebar-link">Configuration</a></li><li><a href="/kubernetes/objects_configs.html" class="sidebar-link">Objects: Data-In</a></li><li><a href="/kubernetes/objects_volumes.html" class="active sidebar-link">Objects: Volumes</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/kubernetes/objects_volumes.html#volume" class="sidebar-link">Volume</a></li><li class="sidebar-sub-header"><a href="/kubernetes/objects_volumes.html#persistentvolume" class="sidebar-link">PersistentVolume</a></li><li class="sidebar-sub-header"><a href="/kubernetes/objects_volumes.html#persistentvolumeclaim" class="sidebar-link">PersistentVolumeClaim</a></li><li class="sidebar-sub-header"><a href="/kubernetes/objects_volumes.html#subpath" class="sidebar-link">SubPath</a></li></ul></li><li><a href="/kubernetes/objects_deployments.html" class="sidebar-link">Objects: Deployments</a></li><li><a href="/kubernetes/objects_services_ingress.html" class="sidebar-link">Objects: Services &amp; Ingress</a></li><li><a href="/kubernetes/cluster.html" class="sidebar-link">My Clusters</a></li><li><a href="/kubernetes/troubleshooting.html" class="sidebar-link">Troubleshooting</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Linux</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/linux/bash_shell.html" class="sidebar-link">Bash Shell</a></li><li><a href="/linux/linux_basics.html" class="sidebar-link">Fundementals</a></li><li><a href="/linux/linux_metrics.html" class="sidebar-link">Metrics</a></li><li><a href="/linux/linux_tools.html" class="sidebar-link">GNU Tools</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Other</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/other/markdown.html" class="sidebar-link">Markdown Cheatsheet</a></li><li><a href="/other/yaml_json.html" class="sidebar-link">YAML &amp; JSON</a></li><li><a href="/other/setup.html" class="sidebar-link">System Setup</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h2 id="volume"><a href="#volume" aria-hidden="true" class="header-anchor">#</a> Volume</h2> <p>At its core, a volume is just a directory, possibly with some data in it, which is accessible to the Containers in a Pod. How that directory comes to be, the medium that backs it, and the contents of it are determined by the particular volume type used.</p> <div class="warning custom-block"><p class="custom-block-title">WARNING</p> <p>You cannot bind two pvc to the same pv, but you can use the same pvc in two different pods.
The relationship PVC &lt;--&gt; PV is one-on-one.</p></div> <h3 id="volume-types"><a href="#volume-types" aria-hidden="true" class="header-anchor">#</a> Volume Types:</h3> <p>Kubernetes supports several types of Volumes (most common):</p> <ul><li>node-local types:
<ul><li><a href="#emptyDir">emptyDir</a></li> <li><a href="#hostPath">hostPath</a></li></ul></li> <li>cloud provider-specific
<ul><li>azureDisk</li> <li><a href="#gcePersistentDisk">gcePersistentDisk</a></li></ul></li> <li>distributed file system
<ul><li>glusterfs</li> <li>cephfs</li></ul></li> <li>special purpose
<ul><li><a href="#configMap">configMap</a></li> <li><a href="#secret">secret</a></li> <li>downwardAPI</li></ul></li> <li><a href="#persistentVolumeClaim">persistentVolumeClaim</a></li></ul> <h4 id="type-configmap"><a href="#type-configmap" aria-hidden="true" class="header-anchor">#</a> Type: configMap</h4> <div class="warning custom-block"><p class="custom-block-title">WARNING</p> <p>You must create a ConfigMap before you can use it.</p></div> <p>The <code>log-config</code> ConfigMap is mounted as a volume, and all contents stored in its <code>log_level</code> entry are mounted into the Pod at path <code>/etc/config/log_level</code>. Note that this path is derived from the volume’s <code>mountPath</code> and the <code>path</code> keyed with <code>log_level</code>.</p> <div class="language-yaml extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> configmap<span class="token punctuation">-</span>pod
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> test
      <span class="token key atrule">image</span><span class="token punctuation">:</span> busybox
      <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> config<span class="token punctuation">-</span>vol
          <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> /etc/config
  <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> config<span class="token punctuation">-</span>vol
      <span class="token key atrule">configMap</span><span class="token punctuation">:</span>
        <span class="token key atrule">name</span><span class="token punctuation">:</span> log<span class="token punctuation">-</span>config
        <span class="token key atrule">items</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token key atrule">key</span><span class="token punctuation">:</span> log_level
            <span class="token key atrule">path</span><span class="token punctuation">:</span> log_level
</code></pre></div><h4 id="type-emptydir"><a href="#type-emptydir" aria-hidden="true" class="header-anchor">#</a> Type: emptyDir</h4> <p>By default, <code>emptyDir</code> volumes are stored on whatever medium is backing the node - that might be disk or SSD or network storage, depending on your environment. However, you can set the <code>emptyDir.medium</code> field to <code>Memory</code> to tell Kubernetes to mount a tmpfs (RAM-backed filesystem) for you instead. While tmpfs is very fast, be aware that unlike disks, tmpfs is cleared on node reboot and any files you write will count against your Container’s memory limit.</p> <div class="language-yaml extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br></div><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> test<span class="token punctuation">-</span>pd
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> k8s.gcr.io/test<span class="token punctuation">-</span>webserver
    <span class="token key atrule">name</span><span class="token punctuation">:</span> test<span class="token punctuation">-</span>container
    <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> /cache
      <span class="token key atrule">name</span><span class="token punctuation">:</span> cache<span class="token punctuation">-</span>volume
  <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> cache<span class="token punctuation">-</span>volume
    <span class="token key atrule">emptyDir</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><h4 id="type-hostpath"><a href="#type-hostpath" aria-hidden="true" class="header-anchor">#</a> Type: hostPath</h4> <p>A <code>hostPath</code> volume mounts a file or directory from the host node’s filesystem into your Pod.
For example, some uses for a <code>hostPath</code> are:</p> <ul><li>running a Container that needs access to Docker internals; use a <code>hostPath</code> of <code>/var/lib/docker</code></li> <li>running cAdvisor in a Container; use a <code>hostPath</code> of <code>/sys</code></li></ul> <p>The supported values for field type are (if empty, no checks will be performed):</p> <table><thead><tr><th>Value</th> <th>Behavior</th></tr></thead> <tbody><tr><td>DirectoryOrCreate</td> <td>If nothing exists at the given path, an empty directory will be created there as needed with permission set to 0755, having the same group and ownership with Kubelet.</td></tr> <tr><td><strong>Directory</strong></td> <td>A directory must exist at the given path</td></tr> <tr><td>FileOrCreate</td> <td>If nothing exists at the given path, an empty file will be created there as needed with permission set to 0644, having the same group and ownership with Kubelet.</td></tr> <tr><td><strong>File</strong></td> <td>A file must exist at the given path</td></tr> <tr><td>Socket</td> <td>A UNIX socket must exist at the given path</td></tr></tbody></table> <div class="language-yaml extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> test<span class="token punctuation">-</span>pd
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> k8s.gcr.io/test<span class="token punctuation">-</span>webserver
    <span class="token key atrule">name</span><span class="token punctuation">:</span> test<span class="token punctuation">-</span>container
    <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> /test<span class="token punctuation">-</span>pd
      <span class="token key atrule">name</span><span class="token punctuation">:</span> test<span class="token punctuation">-</span>volume
  <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> test<span class="token punctuation">-</span>volume
    <span class="token key atrule">hostPath</span><span class="token punctuation">:</span>
      <span class="token comment"># directory location on host</span>
      <span class="token key atrule">path</span><span class="token punctuation">:</span> /data
      <span class="token comment"># this field is optional</span>
      <span class="token key atrule">type</span><span class="token punctuation">:</span> Directory
</code></pre></div><h4 id="type-persistentvolumeclaim"><a href="#type-persistentvolumeclaim" aria-hidden="true" class="header-anchor">#</a> Type: persistentVolumeClaim</h4> <p>A persistentVolumeClaim volume is used to mount a <code>PersistentVolume</code> into a Pod. <code>PersistentVolumes</code> are a way for users to “claim” durable storage (such as a GCE PersistentDisk or an iSCSI volume) without knowing the details of the particular cloud environment.
See the <strong>PersistentVolumes</strong> example for more details.</p> <div class="language-yaml extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br></div><pre class="language-yaml"><code><span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> mypod
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> myfrontend
      <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx
      <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> <span class="token string">&quot;/var/www/html&quot;</span>
        <span class="token key atrule">name</span><span class="token punctuation">:</span> mypd
  <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> mypd
      <span class="token key atrule">persistentVolumeClaim</span><span class="token punctuation">:</span>
        <span class="token key atrule">claimName</span><span class="token punctuation">:</span> myclaim
</code></pre></div><h2 id="persistentvolume"><a href="#persistentvolume" aria-hidden="true" class="header-anchor">#</a> PersistentVolume</h2> <p>There are two ways PVs may be provisioned: statically or dynamically.</p> <ul><li>Static: A cluster administrator creates a number of PVs. They carry the details of the real storage which is available for use by cluster users.</li> <li>Dynamic: When none of the static PVs the administrator created matches a user’s PersistentVolumeClaim, the cluster may try to dynamically provision a volume specially for the PVC. <strong>This provisioning is based on StorageClasses</strong></li></ul> <div class="warning custom-block"><p class="custom-block-title">WARNING</p> <ul><li>PersistentVolumeClaim binds are exclusive, regardless of how they were bound. A PVC to PV binding is a one-to-one mapping.</li> <li>Cluster provisioned with many 50Gi PVs would not match a PVC requesting 100Gi. The PVC can be bound when a 100Gi PV is added to the cluster.</li></ul></div> <h2 id="persistentvolumeclaim"><a href="#persistentvolumeclaim" aria-hidden="true" class="header-anchor">#</a> PersistentVolumeClaim</h2> <p>Creating and using a persistent volume is a three step process:</p> <ol><li>(OPTIONAL) Provision: Administrator provision a networked storage in the cluster, such as AWS ElasticBlockStore volumes. This is called as PersistentVolume.</li> <li>Request storage: User requests storage for pods by using claims. Claims can specify levels of resources (CPU and memory), specific sizes and access modes (e.g. can be mounted once read/write or many times write only). This is called as <code>PersistentVolumeClaim</code>.</li> <li>Use claim: Claims are mounted as volumes and used in pods for storage.</li></ol> <p>The <strong>access mode</strong>s are:</p> <ul><li><code>ReadWriteOnce</code> - the volume can be mounted as read-write by a single node</li> <li><code>ReadOnlyMany</code> - the volume can be mounted read-only by many nodes</li> <li><code>ReadWriteMany</code> - the volume can be mounted as read-write by many nodes</li></ul> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">kind</span><span class="token punctuation">:</span> PersistentVolumeClaim
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> mysql<span class="token punctuation">-</span>volumeclaim
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">accessModes</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> ReadWriteOnce
  <span class="token key atrule">resources</span><span class="token punctuation">:</span>
    <span class="token key atrule">requests</span><span class="token punctuation">:</span>
      <span class="token key atrule">storage</span><span class="token punctuation">:</span> 200Gi
</code></pre></div><h3 id="claims-as-volumes"><a href="#claims-as-volumes" aria-hidden="true" class="header-anchor">#</a> Claims As Volumes</h3> <p>Pods access storage by using the claim as a volume. Claims must exist in the same namespace as the pod using the claim. The cluster finds the claim in the pod’s namespace and uses it to get the PersistentVolume backing the claim. The volume is then mounted to the host and into the pod.</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> mypod
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> myfrontend
      <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx
      <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> <span class="token string">&quot;/var/www/html&quot;</span>
        <span class="token key atrule">name</span><span class="token punctuation">:</span> mypd
  <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> mypd
      <span class="token key atrule">persistentVolumeClaim</span><span class="token punctuation">:</span>
        <span class="token key atrule">claimName</span><span class="token punctuation">:</span> myclaim
</code></pre></div><h2 id="subpath"><a href="#subpath" aria-hidden="true" class="header-anchor">#</a> SubPath</h2> <h4 id="injecting-multiple-kubernetes-volumes-to-the-same-directory"><a href="#injecting-multiple-kubernetes-volumes-to-the-same-directory" aria-hidden="true" class="header-anchor">#</a> Injecting multiple Kubernetes volumes to the same directory</h4> <p>Kubernetes config maps and secrets allow use to inject configuration files into containers. If we want multiple config entries that originate from different config maps or secrets to be injected into the same location, we are required to specify a sub path:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> hello<span class="token punctuation">-</span>world
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">1</span>
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> hello<span class="token punctuation">-</span>world
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> hello<span class="token punctuation">-</span>world
        <span class="token key atrule">image</span><span class="token punctuation">:</span> docker.example.com/app<span class="token punctuation">:</span><span class="token number">1</span>
        <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> hello<span class="token punctuation">-</span>world<span class="token punctuation">-</span>config<span class="token punctuation">-</span>volume
          <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> /config/application.properties
          <span class="token key atrule">subPath</span><span class="token punctuation">:</span> application.properties
          <span class="token key atrule">readOnly</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> hello<span class="token punctuation">-</span>world<span class="token punctuation">-</span>credentials<span class="token punctuation">-</span>volume
          <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> /config/credentials.properties
          <span class="token key atrule">subPath</span><span class="token punctuation">:</span> credentials.properties
          <span class="token key atrule">readOnly</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> hello<span class="token punctuation">-</span>world<span class="token punctuation">-</span>config<span class="token punctuation">-</span>volume
        <span class="token key atrule">configMap</span><span class="token punctuation">:</span>
          <span class="token key atrule">name</span><span class="token punctuation">:</span> hello<span class="token punctuation">-</span>world<span class="token punctuation">-</span>config
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> hello<span class="token punctuation">-</span>world<span class="token punctuation">-</span>credentials<span class="token punctuation">-</span>volume
        <span class="token key atrule">secret</span><span class="token punctuation">:</span>
          <span class="token key atrule">secretName</span><span class="token punctuation">:</span> hello<span class="token punctuation">-</span>world<span class="token punctuation">-</span>credentials
</code></pre></div><p>The <code>subPath</code> declaration also allows to mount a single volume into the pod multiple times with different sub paths.</p></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">2/12/2019, 9:59:20 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/kubernetes/objects_configs.html" class="prev">
          Objects: Data-In
        </a></span> <span class="next"><a href="/kubernetes/objects_deployments.html">
          Objects: Deployments
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.35d179c7.js" defer></script><script src="/assets/js/25.9719470b.js" defer></script>
  </body>
</html>
