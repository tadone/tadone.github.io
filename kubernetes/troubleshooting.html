<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Troubleshooting | Tadone Vuepress</title>
    <meta name="description" content="Tadone Vuepress">
    <link rel="icon" href="/logo.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
  <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
  <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/styles.51f1696e.css" as="style"><link rel="preload" href="/assets/js/app.51f1696e.js" as="script"><link rel="preload" href="/assets/js/26.2e6e5328.js" as="script"><link rel="prefetch" href="/assets/css/1.styles.e3fe890c.css"><link rel="prefetch" href="/assets/css/2.styles.c5aa97a7.css"><link rel="prefetch" href="/assets/js/1.e3fe890c.js"><link rel="prefetch" href="/assets/js/10.87990c44.js"><link rel="prefetch" href="/assets/js/11.8a8d391f.js"><link rel="prefetch" href="/assets/js/12.d48b2b91.js"><link rel="prefetch" href="/assets/js/13.8cbad979.js"><link rel="prefetch" href="/assets/js/14.444da78a.js"><link rel="prefetch" href="/assets/js/15.c0c03324.js"><link rel="prefetch" href="/assets/js/16.79131c79.js"><link rel="prefetch" href="/assets/js/17.0342aa7f.js"><link rel="prefetch" href="/assets/js/18.658e28ec.js"><link rel="prefetch" href="/assets/js/19.56d77f24.js"><link rel="prefetch" href="/assets/js/2.c5aa97a7.js"><link rel="prefetch" href="/assets/js/20.12f407b2.js"><link rel="prefetch" href="/assets/js/21.c2eba41f.js"><link rel="prefetch" href="/assets/js/22.794a92a5.js"><link rel="prefetch" href="/assets/js/23.11e1a93c.js"><link rel="prefetch" href="/assets/js/24.532f4498.js"><link rel="prefetch" href="/assets/js/25.2e9bb212.js"><link rel="prefetch" href="/assets/js/27.b6f90799.js"><link rel="prefetch" href="/assets/js/28.61162adf.js"><link rel="prefetch" href="/assets/js/29.d7a05f22.js"><link rel="prefetch" href="/assets/js/3.f3e56684.js"><link rel="prefetch" href="/assets/js/30.f07e2f56.js"><link rel="prefetch" href="/assets/js/31.37ef77eb.js"><link rel="prefetch" href="/assets/js/32.e260d8e9.js"><link rel="prefetch" href="/assets/js/33.902d8fde.js"><link rel="prefetch" href="/assets/js/34.45b4b139.js"><link rel="prefetch" href="/assets/js/35.d9cb585d.js"><link rel="prefetch" href="/assets/js/36.446886c6.js"><link rel="prefetch" href="/assets/js/37.526af219.js"><link rel="prefetch" href="/assets/js/4.3273090a.js"><link rel="prefetch" href="/assets/js/5.836c6da9.js"><link rel="prefetch" href="/assets/js/6.40427144.js"><link rel="prefetch" href="/assets/js/7.96c5f51b.js"><link rel="prefetch" href="/assets/js/8.1577d1ec.js"><link rel="prefetch" href="/assets/js/9.81183b91.js">
    <link rel="stylesheet" href="/assets/css/1.styles.e3fe890c.css"><link rel="stylesheet" href="/assets/css/2.styles.c5aa97a7.css"><link rel="stylesheet" href="/assets/css/styles.51f1696e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Tadone Vuepress</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://github.com/tadone" target="_blank" rel="noopener noreferrer" class="nav-link external">
  My GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://github.com/tadone" target="_blank" rel="noopener noreferrer" class="nav-link external">
  My GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>Cloud</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/cloud/aws.html" class="sidebar-link">AWS</a></li><li><a href="/cloud/azure.html" class="sidebar-link">Azure</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Code</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/code/git.html" class="sidebar-link">Git</a></li><li><a href="/code/bash.html" class="sidebar-link">Bash Scripting</a></li><li><a href="/code/python.html" class="sidebar-link">Python</a></li><li><a href="/code/python/list.html" class="sidebar-link">Python Lists</a></li><li><a href="/code/python/class.html" class="sidebar-link">Python Classes</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>DevOps</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/devops/cicd.html" class="sidebar-link">CI/CD</a></li><li><a href="/devops/docker.html" class="sidebar-link">Docker</a></li><li><a href="/devops/databases.html" class="sidebar-link">Database Technologies</a></li><li><a href="/devops/sql.html" class="sidebar-link">SQL Basics</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>Kubernetes</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/kubernetes/overview.html" class="sidebar-link">Overview</a></li><li><a href="/kubernetes/kubectl.html" class="sidebar-link">KubeCtl</a></li><li><a href="/kubernetes/cheatsheet.html" class="sidebar-link">Cheatsheet</a></li><li><a href="/kubernetes/configuration.html" class="sidebar-link">Configuration</a></li><li><a href="/kubernetes/objects_configs.html" class="sidebar-link">Objects: Data-In</a></li><li><a href="/kubernetes/objects_volumes.html" class="sidebar-link">Objects: Volumes</a></li><li><a href="/kubernetes/objects_deployments.html" class="sidebar-link">Objects: Deployments</a></li><li><a href="/kubernetes/objects_services_ingress.html" class="sidebar-link">Objects: Services &amp; Ingress</a></li><li><a href="/kubernetes/cluster.html" class="sidebar-link">My Clusters</a></li><li><a href="/kubernetes/troubleshooting.html" class="active sidebar-link">Troubleshooting</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/kubernetes/troubleshooting.html#find-pods" class="sidebar-link">Find Pods</a></li><li class="sidebar-sub-header"><a href="/kubernetes/troubleshooting.html#pods-phases" class="sidebar-link">Pods Phases</a></li><li class="sidebar-sub-header"><a href="/kubernetes/troubleshooting.html#search-logs" class="sidebar-link">Search Logs</a></li><li class="sidebar-sub-header"><a href="/kubernetes/troubleshooting.html#pod-crashing" class="sidebar-link">Pod Crashing</a></li><li class="sidebar-sub-header"><a href="/kubernetes/troubleshooting.html#node-not-schedulable" class="sidebar-link">Node Not Schedulable</a></li></ul></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Linux</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/linux/bash_shell.html" class="sidebar-link">Bash Shell</a></li><li><a href="/linux/linux_basics.html" class="sidebar-link">Fundementals</a></li><li><a href="/linux/linux_metrics.html" class="sidebar-link">Metrics</a></li><li><a href="/linux/linux_tools.html" class="sidebar-link">GNU Tools</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Other</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/other/markdown.html" class="sidebar-link">Markdown Cheatsheet</a></li><li><a href="/other/yaml_json.html" class="sidebar-link">YAML &amp; JSON</a></li><li><a href="/other/setup.html" class="sidebar-link">System Setup</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="troubleshooting-kubernetes"><a href="#troubleshooting-kubernetes" aria-hidden="true" class="header-anchor">#</a> Troubleshooting Kubernetes</h1> <ul><li><a href="https://kukulinski.com/10-most-common-reasons-kubernetes-deployments-fail-part-1/" target="_blank" rel="noopener noreferrer">10 Most Common Reasons Kubernetes Deployments Fail (Part 1)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://kukulinski.com/10-most-common-reasons-kubernetes-deployments-fail-part-2/" target="_blank" rel="noopener noreferrer">10 Most Common Reasons Kubernetes Deployments Fail (Part 2)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>When pods are not ready for a long time or they restart multiple times:</p> <ul><li><code>kubectl describe pod &lt;pod_name&gt; -n &lt;optional_namespace&gt;</code></li> <li><code>kubectl describe deployment &lt;deployment_name&gt;</code></li> <li><code>kubectl describe replicaset &lt;replicaset_name&gt;</code></li></ul> <h2 id="find-pods"><a href="#find-pods" aria-hidden="true" class="header-anchor">#</a> Find Pods</h2> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># Example sorting pods by nodeName:</span>
kubectl get pods -o wide --sort-by<span class="token operator">=</span><span class="token string">&quot;{.spec.nodeName}&quot;</span>
<span class="token comment"># find all pods that not in running phase:</span>
kubectl get pods --field-selector<span class="token operator">=</span>status.phase<span class="token operator">!=</span>Running --all-namespaces
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># Example of getting pods on nodes using label filter:</span>
kubectl get pods --all-namespaces  --no-headers --field-selector spec.nodeName<span class="token operator">=</span><span class="token string">&quot;k8s-workers-17781035-2&quot;</span>

<span class="token comment"># Or for all nodes:</span>
<span class="token keyword">for</span> n <span class="token keyword">in</span> <span class="token variable"><span class="token variable">$(</span>kubectl get nodes -l your_label_key<span class="token operator">=</span>your_label_value --no-headers <span class="token operator">|</span> <span class="token function">cut</span> -d <span class="token string">&quot; &quot;</span> -f1<span class="token variable">)</span></span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    kubectl get pods --all-namespaces  --no-headers --field-selector spec.nodeName<span class="token operator">=</span><span class="token variable">${n}</span>
<span class="token keyword">done</span>

<span class="token comment"># Sort by number of restarts:</span>
kubectl get pods --sort-by<span class="token operator">=</span><span class="token string">&quot;{.status.containerStatuses[:1].restartCount}&quot;</span>
</code></pre></div><h2 id="pods-phases"><a href="#pods-phases" aria-hidden="true" class="header-anchor">#</a> Pods Phases</h2> <p>The phase of a Pod is a simple, high-level summary of where the Pod is in its lifecycle.</p> <p><strong>Pending:</strong>	The Pod has been accepted by the Kubernetes system, but one or more of the Container images has not been created. This includes time before being scheduled as well as time spent downloading images over the network, which could take a while.</p> <p><strong>Running:</strong>	The Pod has been bound to a node, and all of the Containers have been created. At least one Container is still running, or is in the process of starting or restarting.</p> <p><strong>Succeeded:</strong>	All Containers in the Pod have terminated in success, and will not be restarted.</p> <p><strong>Failed:</strong>	All Containers in the Pod have terminated, and at least one Container has terminated in failure. That is, the Container either exited with non-zero status or was terminated by the system.</p> <p><strong>Unknown:</strong>	For some reason the state of the Pod could not be obtained, typically due to an error in communicating with the host of the Pod.</p> <h2 id="search-logs"><a href="#search-logs" aria-hidden="true" class="header-anchor">#</a> Search Logs</h2> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># Use exec to run commands inside a container</span>
$ kubectl <span class="token function">exec</span> cassandra -- <span class="token function">cat</span> /var/log/cassandra/system.log
<span class="token comment"># If your container has previously crashed, you can access the previous container's crash log with:</span>
$ kubectl logs --previous <span class="token variable">${POD_NAME}</span> <span class="token variable">${CONTAINER_NAME}</span>
</code></pre></div><h2 id="pod-crashing"><a href="#pod-crashing" aria-hidden="true" class="header-anchor">#</a> Pod Crashing</h2> <h4 id="pod-crashloopbackoff-starting-then-crashing-then-starting-again-and-crashing-again"><a href="#pod-crashloopbackoff-starting-then-crashing-then-starting-again-and-crashing-again" aria-hidden="true" class="header-anchor">#</a> Pod CrashLoopBackOff: starting, then crashing, then starting again and crashing again</h4> <ul><li><a href="https://kubernetes.io/docs/tasks/debug-application-cluster/debug-init-containers/" target="_blank" rel="noopener noreferrer">Kubernetes.io/Debug-Init-Containers<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <table><thead><tr><th>Status</th> <th>Meaning</th></tr></thead> <tbody><tr><td>Init:N/M</td> <td>The Pod has M Init Containers, and N have completed so far.</td></tr> <tr><td>Init:Error</td> <td>An Init Container has failed to execute.</td></tr> <tr><td>Init:CrashLoopBackOff</td> <td>An Init Container has failed repeatedly.</td></tr> <tr><td>Pending</td> <td>The Pod has not yet begun executing Init Containers.</td></tr> <tr><td>PodInitializing or Running</td> <td>The Pod has already finished executing Init Containers.</td></tr> <tr><td>ImagePullBackOff</td> <td>Could not pull the image from registry</td></tr> <tr><td>CrashLoopBackOff</td> <td>Application Crashing after Launch</td></tr> <tr><td>RunContainerError</td> <td>Missing ConfigMap</td></tr> <tr><td>ContainerCreating</td> <td>(Stuck for long time) Missing secret</td></tr> <tr><td>Pending (Other)</td> <td>Resource Quotas, Insufficient Cluster Resources, PersistentVolume fails to mount</td></tr></tbody></table> <h2 id="node-not-schedulable"><a href="#node-not-schedulable" aria-hidden="true" class="header-anchor">#</a> Node Not Schedulable</h2> <p>Find out what's wrong with a node:</p> <ul><li><code>kubectl get nodes</code> for status of nodes</li> <li><code>kubectl top node &lt;node_name&gt;</code> for resource allocation</li> <li><code>kubectl describe node &lt;node_namee&gt;</code> to get more indepth info about the node</li></ul> <p>SSH to a node to view the logs: <code>journalctl -u kubelet</code></p></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">11/2/2018, 10:26:10 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/kubernetes/cluster.html" class="prev">
          My Clusters
        </a></span> <span class="next"><a href="/linux/bash_shell.html">
          Bash Shell
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/26.2e6e5328.js" defer></script><script src="/assets/js/app.51f1696e.js" defer></script>
  </body>
</html>
